# Studymate Server

μ¤ν„°λ””λ©”μ΄νΈ ν”„λ΅μ νΈμ λ°±μ—”λ“ μ„λ²„μ…λ‹λ‹¤.

## β οΈ μ¤‘μ” λ¬Έμ„ μ•λ‚΄

**λ§μ¤ν„° PRD**: `../STYDYMATE-CLIENT/.taskmaster/docs/prd.txt`κ°€ μ „μ²΄ STUDYMATE ν”„λ΅μ νΈμ **Single Source of Truth**μ…λ‹λ‹¤.

**λ¬Έμ„ κµ¬μ΅°**:
- `STUDYMATE-SERVER/docs/` - λ°±μ—”λ“, API, DB, μ‹μ¤ν… μ•„ν‚¤ν…μ² λ¬Έμ„ (μ΄κ³³μ—μ„ κ΄€λ¦¬)
- `STYDYMATE-CLIENT/docs/` - ν”„λ΅ νΈμ—”λ“ μ „μ© λ¬Έμ„ (μ¤νƒ€μΌ κ°€μ΄λ“, Cloudflare λ°°ν¬ λ“±)
- `STYDYMATE-CLIENT/.taskmaster/docs/prd.txt` - μ „μ²΄ ν”„λ΅μ νΈ λ§μ¤ν„° PRD

## λ©μ°¨

- [ν”„λ΅μ νΈ μ†κ°](#ν”„λ΅μ νΈ-μ†κ°)
- [π“ λ¬Έμ„ κµ¬μ΅°](#-λ¬Έμ„-κµ¬μ΅°)
- [κΈ°μ  μ¤νƒ](#κΈ°μ -μ¤νƒ)
- [NCP λ°°ν¬ μ•„ν‚¤ν…μ²](#ncp-λ°°ν¬-μ•„ν‚¤ν…μ²)
- [μ‹μ‘ν•κΈ°](#μ‹μ‘ν•κΈ°)

## ν”„λ΅μ νΈ μ†κ°

STUDYMATEλ” μ‹¤μ‹κ°„ ν™”μƒν†µν™”μ™€ AI κΈ°λ° λ λ²¨ ν…μ¤νΈλ¥Ό ν†µν•΄ μ „ μ„Έκ³„ μ‚¬μ©μλ“¤μ΄ μ–Έμ–΄λ¥Ό κµν™ν•λ©° ν•™μµν•  μ μλ” ν”λ«νΌμ…λ‹λ‹¤.

μ΄ μ €μ¥μ†λ” Spring Boot κΈ°λ°μ λ°±μ—”λ“ API μ„λ²„λ΅, μ‚¬μ©μ μΈμ¦, μ±„ν…, λ§¤μΉ­, μ¨λ³΄λ”© λ“±μ ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤.

## π“ λ¬Έμ„ κµ¬μ΅°

### λ°±μ—”λ“ κ΄€λ¦¬ λ¬Έμ„ (μ΄ ν”„λ΅μ νΈ)
```
STUDYMATE-SERVER/docs/
β”β”€β”€ 01-overview/           # ν”„λ΅μ νΈ μ „μ²΄ κ°μ”
β”β”€β”€ 02-requirements/       # μ”κµ¬μ‚¬ν•­ (λ°±μ—”λ“ κ΄€μ )
β”β”€β”€ 03-architecture/       # μ‹μ¤ν… μ•„ν‚¤ν…μ²
β”β”€β”€ 04-api/               # REST API & WebSocket λ…μ„Έ
β”β”€β”€ 05-database/          # DB μ¤ν‚¤λ§, Redis μ „λµ
β”β”€β”€ 07-backend/           # λ°±μ—”λ“ μ„λΉ„μ¤, μ—λ¬ μ²λ¦¬
β”β”€β”€ 08-infrastructure/    # NCP λ°°ν¬, μΈν”„λΌ
β”β”€β”€ 09-processes/         # κ°λ° μ›ν¬ν”λ΅μ°
β”β”€β”€ 10-decisions/         # κΈ°μ  μ¤νƒ κ²°μ •μ‚¬ν•­
β””β”€β”€ 99-logs/              # μ‘μ—… λ΅κ·Έ (μ‹¤μ  μ„Έμ… 3κ°)
```

### ν΄λΌμ΄μ–ΈνΈ μ „μ© λ¬Έμ„ (STYDYMATE-CLIENT)
```
STYDYMATE-CLIENT/docs/
β”β”€β”€ 06-frontend/          # React μ»΄ν¬λ„νΈ, μ¤νƒ€μΌ κ°€μ΄λ“
β”β”€β”€ 08-infrastructure/    # Cloudflare Pages λ°°ν¬
β””β”€β”€ 99-logs/              # ν΄λΌμ΄μ–ΈνΈ μ‘μ—… λ΅κ·Έ
```

### λ§μ¤ν„° λ¬Έμ„
- **[μ „μ²΄ ν”„λ΅μ νΈ PRD](../STYDYMATE-CLIENT/.taskmaster/docs/prd.txt)** - 252μ¤„μ μƒμ„Έν• μ „μ²΄ μ”κµ¬μ‚¬ν•­

## β οΈ μ„λ²„ κ°λ° μ‹ ν•„μ μ°Έμ΅° λ¬Έμ„

**λ°±μ—”λ“ κ°λ°μλ” λ‹¤μ ν΄λΌμ΄μ–ΈνΈ λ¬Έμ„λ¥Ό λ°λ“μ‹ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤:**

### π¨ ν”„λ΅ νΈμ—”λ“ μ—°λ™ ν•„μ
- **[μ¤νƒ€μΌ κ°€μ΄λ“](../STYDYMATE-CLIENT/docs/06-frontend/style-guide.md)** - UI μ»΄ν¬λ„νΈ λ””μμΈ κ·κ²© (API μ‘λ‹µ ν•μ‹μ— μν–¥)
- **[React μ»΄ν¬λ„νΈ](../STYDYMATE-CLIENT/docs/06-frontend/components/README.md)** - ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ κµ¬μ΅° μ΄ν•΄

### β™οΈ Node.js Workers μ—°λ™ 
- **[TaskMaster PRD](../STYDYMATE-CLIENT/.taskmaster/docs/prd.txt)** - Section 3: Node.js λ°±μ—”λ“ κ°λ° νƒμ¤ν¬ (119-189μ¤„)
  - WebRTC μ‹κ·Έλ„λ§ μ„λ²„ μ—°λ™
  - AI λ λ²¨ν…μ¤νΈ API μ—°λ™  
  - Cloudflare Workers/Durable Objects μ—°λ™

### π”— ν•„μ μ²΄ν¬ μ‚¬ν•­
- **API μ‘λ‹µ ν•μ‹**: ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ κΈ°λ€ν•λ” λ°μ΄ν„° κµ¬μ΅° ν™•μΈ
- **WebSocket μ΄λ²¤νΈ**: ν΄λΌμ΄μ–ΈνΈμ—μ„ μ²λ¦¬ν•λ” μ΄λ²¤νΈ νƒ€μ… ν™•μΈ
- **μ—λ¬ μ²λ¦¬**: ν΄λΌμ΄μ–ΈνΈ μ—λ¬ ν•Έλ“¤λ§κ³Ό μΌμΉν•λ” μ—λ¬ μ½”λ“ μ‚¬μ©

## π“ λ¬Έμ„ μ—…λ°μ΄νΈ ν•„μ κ·μΉ™

### β οΈ λ°±μ—”λ“ κ°λ°μ μ λ€ μ›μΉ™
1. **API λ³€κ²½ = λ¬Έμ„ μ—…λ°μ΄νΈ ν•„μ**
   - Controller λ³€κ²½ β†’ `docs/04-api/api-reference.md` μ—…λ°μ΄νΈ
   - DTO λ³€κ²½ β†’ ν΄λΌμ΄μ–ΈνΈ TypeScript μΈν„°νμ΄μ¤ ν™•μΈ μ”μ²­  
   - Entity λ³€κ²½ β†’ `docs/05-database/database-schema.md` μ—…λ°μ΄νΈ
   - μ—λ¬ μ½”λ“ μ¶”κ°€ β†’ `docs/07-backend/error-handling.md` μ—…λ°μ΄νΈ

2. **ν΄λΌμ΄μ–ΈνΈ μ—°λ™ ν™•μΈ μλ¬΄**
   - API μ‘λ‹µ λ³€κ²½ μ‹ β†’ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ”κµ¬μ‚¬ν•­ ν™•μΈ
   - WebSocket μ΄λ²¤νΈ λ³€κ²½ μ‹ β†’ ν΄λΌμ΄μ–ΈνΈ μ΄λ²¤νΈ ν•Έλ“¤λ¬ ν™•μΈ
   - μ—λ¬ μ‘λ‹µ λ³€κ²½ μ‹ β†’ ν΄λΌμ΄μ–ΈνΈ μ—λ¬ μ²λ¦¬ λ΅μ§ ν™•μΈ

3. **μƒνΈ μ°Έμ΅° λ¬Έμ„ λ™κΈ°ν™”**
   - `src/*/dto/response/` β†” ν΄λΌμ΄μ–ΈνΈ TypeScript interface  
   - WebSocket μ΄λ²¤νΈ β†” ν΄λΌμ΄μ–ΈνΈ μ΄λ²¤νΈ λ¦¬μ¤λ„
   - μ—λ¬ μ½”λ“ β†” ν΄λΌμ΄μ–ΈνΈ μ—λ¬ λ©”μ‹μ§€

### π”„ λ°±μ—”λ“ μ—…λ°μ΄νΈ μ›ν¬ν”λ΅μ°
```bash
# 1. API λ³€κ²½ μ „ ν΄λΌμ΄μ–ΈνΈ μ”κµ¬μ‚¬ν•­ ν™•μΈ
ls ../STYDYMATE-CLIENT/src/types/  # TypeScript μΈν„°νμ΄μ¤ ν™•μΈ
cat ../STYDYMATE-CLIENT/docs/06-frontend/components/README.md

# 2. λ°±μ—”λ“ κ°λ° μ§„ν–‰  
# ... Controller, Service, DTO μ‘μ„± ...

# 3. λ¬Έμ„ μ—…λ°μ΄νΈ (ν•„μ!)
# - docs/04-api/api-reference.md (API λ…μ„Έ)
# - docs/07-backend/error-handling.md (μ—λ¬ μ½”λ“)  
# - docs/05-database/ (DB λ³€κ²½μ‹)

# 4. ν΄λΌμ΄μ–ΈνΈ ν€μ— λ³€κ²½μ‚¬ν•­ μ•λ¦Ό
git add . && git commit -m "feat: API κΈ°λ¥λ…
- λ°±μ—”λ“ λ³€κ²½ λ‚΄μ©  
- π“ API λ¬Έμ„ μ—…λ°μ΄νΈ μ™„λ£
- β οΈ ν΄λΌμ΄μ–ΈνΈ TypeScript μΈν„°νμ΄μ¤ ν™•μΈ ν•„μ”"
```

### π”— ν¬λ΅μ¤ ν”„λ΅μ νΈ ν™•μΈ μ²΄ν¬λ¦¬μ¤νΈ  
- [ ] DTO Response λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ TypeScript interface μΌμΉ ν™•μΈ
- [ ] API μ—”λ“ν¬μΈνΈ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ API νΈμ¶ μ½”λ“ ν™•μΈ
- [ ] WebSocket μ΄λ²¤νΈ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ΄λ²¤νΈ ν•Έλ“¤λ¬ ν™•μΈ
- [ ] μ—λ¬ μ½”λ“ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ—λ¬ μ²λ¦¬ λ΅μ§ ν™•μΈ  
- [ ] μƒνƒ κ°’ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μƒνƒ κ΄€λ¦¬ store ν™•μΈ

## κΈ°μ  μ¤νƒ

- **Language:** Java 17
- **Framework:** Spring Boot 3
- **Database:** MySQL
- **Cache:** Redis
- **Build Tool:** Gradle

---

## NCP λ°°ν¬ μ•„ν‚¤ν…μ²

μ΄ ν”„λ΅μ νΈλ” Naver Cloud Platform(NCP)μ— κ³ κ°€μ©μ„± λ° λ³΄μ•μ„ κ³ λ ¤ν•μ—¬ λ°°ν¬λ©λ‹λ‹¤.

### μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨

```
+---------------------------------------------------------------------------------+
|                                  Internet                                       |
+----------------------------------+----------------------------------------------+
                                   |
                                   v
+--------------------------+---------------------------+
|     languagemate.kr      |      DNS (NCP)            |
+--------------------------+---------------------------+
                                   |
                                   v
+---------------------------------------------------------------------------------+
|                            VPC (studymate-vpc) 10.0.0.0/16                        |
|                                                                                 |
| +-----------------------------------------------------------------------------+ |
| | Public Subnet (studymate-public-subnet) 10.0.1.0/24                         | |
| |                                                                             | |
| |   +-------------------------+      +------------------------------------+   | |
| |   |   Internet Gateway      |----->|  Load Balancer (studymate-lb)      |   | |
| |   +-------------------------+      |   - Public IP                      |   | |
| |                                    |   - ACG: studymate-lb-acg          |   | |
| |                                    |   - NACL: studymate-public-nacl    |   | |
| |                                    |   - SSL/TLS Offloading             |   | |
| |                                    +------------------+-----------------+   | |
| +-------------------------------------------------------|---------------------+ |
|                                                         | (HTTPS/443 -> HTTP/8080)
|                                                         v
| +-----------------------------------------------------------------------------+ |
| | Private Subnet (studymate-private-subnet) 10.0.2.0/24                       | |
| |                                                                             | |
| |   +-------------------------+      +------------------------------------+   | |
| |   |    NAT Gateway          |<---->|  Server Instance (VM)              |   | |
| |   |   (Outbound Traffic)    |      |   - Private IP                     |   | |
| |   +-------------------------+      |   - ACG: studymate-server-acg      |   | |
| |                                    |   - NACL: studymate-private-nacl   |   | |
| |                                    |                                    |   | |
| |                                    |   +------------------------------+ |   | |
| |                                    |   | Docker Engine                | |   | |
| |                                    |   |  - studymate-app (Java)      | |   | |
| |                                    |   |  - studymate-db (MySQL)      | |   | |
| |                                    |   |  - studymate-redis (Redis)   | |   | |
| |                                    |   +------------------------------+ |   | |
| |                                    +------------------------------------+   | |
| +-----------------------------------------------------------------------------+ |
|                                                                                 |
+---------------------------------------------------------------------------------+
```

### λ„¤νΈμ›ν¬ κµ¬μ„±

-   **VPC (`studymate-vpc`):** `10.0.0.0/16` λ€μ—­μ„ μ‚¬μ©ν•λ” κ²©λ¦¬λ κ°€μƒ λ„¤νΈμ›ν¬μ…λ‹λ‹¤.
-   **Public Subnet (`studymate-public-subnet`):** `10.0.1.0/24` λ€μ—­μ„ μ‚¬μ©ν•λ©°, μ™Έλ¶€ μΈν„°λ„·κ³Ό μ§μ ‘ ν†µμ‹ ν•λ” λ¦¬μ†μ¤(λ΅λ“λ°Έλ°μ„)κ°€ μ„μΉν•©λ‹λ‹¤.
    -   **Internet Gateway:** VPCμ™€ μ™Έλ¶€ μΈν„°λ„· κ°„μ ν†µμ‹ μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤.
-   **Private Subnet (`studymate-private-subnet`):** `10.0.2.0/24` λ€μ—­μ„ μ‚¬μ©ν•λ©°, μ™Έλ¶€μ—μ„ μ§μ ‘ μ ‘κ·Όν•  μ μ—†λ” λ‚΄λ¶€ λ¦¬μ†μ¤(μ• ν”λ¦¬μΌ€μ΄μ… μ„λ²„)κ°€ μ„μΉν•©λ‹λ‹¤.
    -   **NAT Gateway:** Private Subnetμ μ„λ²„κ°€ μ™Έλ¶€ μΈν„°λ„·(μ: GitHub, μ™Έλ¶€ API)μΌλ΅ λ‚κ°€λ” μ•„μ›ƒλ°”μ΄λ“ ν†µμ‹ μ„ μ„ν•΄ μ‚¬μ©λ©λ‹λ‹¤.

### λ³΄μ• μ„¤μ •

-   **Network ACL (NACL):** μ„λΈλ„· λ λ²¨μ λ°©ν™”λ²½μΌλ΅, Stateless λ°©μ‹μΌλ΅ λ™μ‘ν•©λ‹λ‹¤.
    -   `studymate-public-nacl`: Public Subnetμ— μ μ©λλ©°, HTTP(80), HTTPS(443) νΈλν”½λ§ ν—μ©ν•©λ‹λ‹¤.
    -   `studymate-private-nacl`: Private Subnetμ— μ μ©λλ©°, λ΅λ“λ°Έλ°μ„λ΅λ¶€ν„°μ 8080 ν¬νΈ νΈλν”½κ³Ό κ΄€λ¦¬μ SSH μ ‘μ† λ“± μµμ†ν•μ νΈλν”½λ§ ν—μ©ν•©λ‹λ‹¤.
-   **ACG (Access Control Group):** μ„λ²„ μΈμ¤ν„΄μ¤ λ λ²¨μ λ°©ν™”λ²½μΌλ΅, Stateful λ°©μ‹μΌλ΅ λ™μ‘ν•©λ‹λ‹¤.
    -   `studymate-lb-acg`: λ΅λ“λ°Έλ°μ„μ— μ μ©λλ©°, HTTP(80), HTTPS(443) νΈλν”½μ„ ν—μ©ν•©λ‹λ‹¤.
    -   `studymate-server-acg`: μ„λ²„ μΈμ¤ν„΄μ¤μ— μ μ©λλ©°, λ΅λ“λ°Έλ°μ„κ°€ μ†ν• Public Subnet λ€μ—­μ—μ„μ 8080 ν¬νΈ μ ‘κ·Όκ³Ό κ΄€λ¦¬μ IPμ—μ„μ SSH(22) μ ‘κ·Όλ§ ν—μ©ν•©λ‹λ‹¤.

### μ„λ²„ λ° λ°°ν¬

-   **μ„λ²„ μΈμ¤ν„΄μ¤:** Private Subnetμ— μ„μΉν•λ©°, μ™Έλ¶€μ—μ„ μ§μ ‘ μ ‘κ·Όμ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.
-   **λ΅λ“λ°Έλ°μ„:** Application Load Balancerλ¥Ό μ‚¬μ©ν•μ—¬ `languagemate.kr` λ„λ©”μΈμ HTTPS μ”μ²­μ„ λ°›μ•„ μ„λ²„μ 8080 ν¬νΈλ΅ μ „λ‹¬ν•©λ‹λ‹¤. SSL μΈμ¦μ„ κ΄€λ¦¬ λ° μ•”νΈν™”/λ³µνΈν™”(SSL Offloading)λ¥Ό λ‹΄λ‹Ήν•©λ‹λ‹¤.
-   **λ°°ν¬ λ°©μ‹:**
    -   GitHub Actionsλ¥Ό ν†µν•΄ CI/CD νμ΄ν”„λΌμΈμ„ κµ¬μ¶•ν•©λ‹λ‹¤.
    -   μ• ν”λ¦¬μΌ€μ΄μ…, MySQL, Redisλ” μ„λ²„ μΈμ¤ν„΄μ¤ λ‚΄μ Docker μ»¨ν…μ΄λ„λ΅ μ‹¤ν–‰λλ©°, `docker-compose`λ¥Ό ν†µν•΄ κ΄€λ¦¬λ©λ‹λ‹¤.
    -   GitHub Actionsλ” μ½”λ“λ¥Ό λΉλ“ν•κ³  Docker μ΄λ―Έμ§€λ¥Ό μƒμ„±ν•μ—¬ NCP Container Registryμ— ν‘Έμ‹ν• ν›„, SSHλ¥Ό ν†µν•΄ μ„λ²„μ— μ ‘μ†ν•μ—¬ μµμ‹  μ΄λ―Έμ§€λ¥Ό λ°›μ•„ μ„λΉ„μ¤λ¥Ό μ¬μ‹μ‘ν•λ” λ°©μ‹μΌλ΅ λ°°ν¬λ¥Ό μλ™ν™”ν•©λ‹λ‹¤.

## μ‹μ‘ν•κΈ°

(μ—¬κΈ°μ— λ΅μ»¬ ν™κ²½μ—μ„ ν”„λ΅μ νΈλ¥Ό μ‹¤ν–‰ν•λ” λ°©λ²•μ„ μ¶”κ°€ν•΄μ£Όμ„Έμ”.)
