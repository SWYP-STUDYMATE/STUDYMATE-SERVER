# 📋 기능 요구사항 명세서

## 📅 문서 정보
- **최종 업데이트**: 2025-08-27
- **작성자**: Product Team
- **목적**: STUDYMATE 프로젝트의 세부 기능 요구사항 정의

---

## 🎯 기능 요구사항 개요

### 요구사항 분류 체계
- **FR-01**: 사용자 관리 (User Management)
- **FR-02**: 인증 및 권한 (Authentication & Authorization)
- **FR-03**: 온보딩 프로세스 (Onboarding Process)
- **FR-04**: 실시간 채팅 (Real-time Chat)
- **FR-05**: 매칭 시스템 (Matching System)
- **FR-06**: AI 레벨 테스트 (AI Level Test)
- **FR-07**: 화상/음성 통화 (Video/Audio Call)
- **FR-08**: 학습 관리 (Learning Management)

---

## 👤 FR-01: 사용자 관리

### FR-01-01: 사용자 프로필 관리
**우선순위**: 필수 (P0)  
**설명**: 사용자의 기본 프로필 정보를 관리한다.

#### 상세 요구사항
- **FR-01-01-01**: 프로필 정보 조회
  - 사용자는 본인의 프로필 정보를 조회할 수 있다
  - 조회 항목: 영어명, 자기소개, 위치, 프로필 이미지
  
- **FR-01-01-02**: 프로필 정보 수정
  - 사용자는 본인의 프로필 정보를 수정할 수 있다
  - 수정 가능 항목: 영어명, 자기소개, 위치
  - 영어명은 필수 입력 항목이다 (최대 50자)
  - 자기소개는 선택 항목이다 (최대 500자)
  
- **FR-01-01-03**: 프로필 이미지 관리
  - 사용자는 프로필 이미지를 업로드할 수 있다
  - 지원 형식: JPG, PNG (최대 5MB)
  - 업로드된 이미지는 CDN을 통해 서빙된다

#### 인수 기준
```gherkin
Given 인증된 사용자가 시스템에 로그인했을 때
When 프로필 수정 요청을 보내면
Then 프로필 정보가 성공적으로 업데이트되어야 한다
And 변경된 정보가 즉시 반영되어야 한다
```

### FR-01-02: 계정 관리
**우선순위**: 필수 (P0)  
**설명**: 사용자 계정의 생성, 수정, 삭제를 관리한다.

#### 상세 요구사항
- **FR-01-02-01**: 계정 비활성화
  - 사용자는 본인 계정을 임시 비활성화할 수 있다
  - 비활성화된 계정은 매칭 대상에서 제외된다
  
- **FR-01-02-02**: 계정 탈퇴
  - 사용자는 본인 계정을 영구 삭제할 수 있다
  - 탈퇴 시 개인정보는 즉시 삭제된다
  - 채팅 히스토리는 익명화 처리된다

---

## 🔐 FR-02: 인증 및 권한

### FR-02-01: OAuth 인증
**우선순위**: 필수 (P0)  
**설명**: 외부 OAuth 제공자를 통한 사용자 인증을 지원한다.

#### 상세 요구사항
- **FR-02-01-01**: Naver OAuth 로그인
  - 사용자는 Naver 계정으로 로그인할 수 있다
  - 최초 로그인 시 자동으로 계정이 생성된다
  - Naver 프로필 정보가 자동으로 동기화된다
  
- **FR-02-01-02**: Google OAuth 로그인
  - 사용자는 Google 계정으로 로그인할 수 있다
  - 기존 계정과 연결 기능을 지원한다

#### 기술적 구현
```yaml
Naver OAuth:
  - Client ID/Secret 기반 인증
  - 사용자 프로필 정보 자동 수집
  - Refresh Token 지원

Google OAuth:
  - OpenID Connect 표준 준수
  - JWT ID Token 검증
```

### FR-02-02: JWT 토큰 관리
**우선순위**: 필수 (P0)  
**설명**: JWT 기반 무상태 인증 시스템을 구현한다.

#### 상세 요구사항
- **FR-02-02-01**: Access Token 발급
  - 로그인 성공 시 Access Token을 발급한다
  - 토큰 유효기간: 1시간
  - 토큰에 사용자 ID와 권한 정보를 포함한다
  
- **FR-02-02-02**: Refresh Token 관리
  - 장기간 인증 유지를 위한 Refresh Token을 제공한다
  - Refresh Token 유효기간: 7일
  - Redis에 안전하게 저장한다

#### 보안 요구사항
- 모든 API 엔드포인트는 인증이 필요하다 (공개 엔드포인트 제외)
- 토큰은 HTTP-Only 쿠키 또는 Authorization 헤더로 전송한다
- 토큰 탈취 방지를 위한 추가 보안 검증을 수행한다

---

## 📝 FR-03: 온보딩 프로세스

### FR-03-01: 언어 설정
**우선순위**: 필수 (P0)  
**설명**: 사용자의 언어 학습 목표와 현재 수준을 설정한다.

#### 상세 요구사항
- **FR-03-01-01**: 학습 언어 선택
  - 사용자는 학습하고자 하는 언어를 선택한다
  - 현재 지원: 영어 (향후 확장 예정)
  
- **FR-03-01-02**: 언어 수준 설정
  - 사용자는 현재 언어 수준을 선택한다
  - CEFR 기준: A1, A2, B1, B2, C1, C2
  - 목표 수준도 함께 설정한다
  
- **FR-03-01-03**: 모국어 설정
  - 사용자의 모국어를 설정한다
  - 매칭 시 언어 교환 기준으로 활용된다

### FR-03-02: 학습 스타일 설정
**우선순위**: 필수 (P0)  
**설명**: 개인별 학습 선호도를 수집한다.

#### 상세 요구사항
- **FR-03-02-01**: 학습 동기 선택
  - 여행, 비즈니스, 학업, 취미 등 학습 목적을 선택한다
  - 다중 선택 가능하다
  
- **FR-03-02-02**: 학습 방법 선택
  - 선호하는 학습 방법을 선택한다
  - 옵션: 대화 중심, 문법 중심, 혼합형
  
- **FR-03-02-03**: 소통 방법 선택
  - 선호하는 소통 방식을 선택한다
  - 옵션: 채팅만, 음성 통화, 화상 통화, 모든 방식

### FR-03-03: 파트너 선호도 설정
**우선순위**: 중요 (P1)  
**설명**: 매칭 시 고려할 파트너 선호도를 설정한다.

#### 상세 요구사항
- **FR-03-03-01**: 성별 선호도
  - 매칭 파트너의 성별 선호도를 설정한다
  - 옵션: 무관, 같은 성별, 다른 성별
  
- **FR-03-03-02**: 나이대 선호도
  - 선호하는 파트너의 나이대를 설정한다
  - 연령대별 구간으로 선택한다
  
- **FR-03-03-03**: 성격 유형 선호도
  - MBTI 기반 성격 유형 선호도를 설정한다
  - 선택 사항이며 매칭 우선순위에 반영한다

### FR-03-04: 스케줄 설정
**우선순위**: 중요 (P1)  
**설명**: 사용자의 학습 가능 시간을 설정한다.

#### 상세 요구사항
- **FR-03-04-01**: 요일별 시간 설정
  - 요일별로 학습 가능한 시간대를 설정한다
  - 시간 단위: 30분 단위
  - 여러 시간대 선택 가능하다
  
- **FR-03-04-02**: 타임존 설정
  - 사용자의 타임존을 자동 감지하거나 수동 설정한다
  - 매칭 시 시차를 고려한다

#### 온보딩 완료 조건
```yaml
필수 항목:
  - 학습 언어 선택
  - 언어 수준 설정
  - 모국어 설정
  - 학습 동기 선택

선택 항목:
  - 파트너 선호도 설정
  - 스케줄 설정
  - AI 레벨 테스트 수행
```

---

## 💬 FR-04: 실시간 채팅

### FR-04-01: 채팅방 관리
**우선순위**: 필수 (P0)  
**설명**: 1:1 채팅방의 생성, 관리, 삭제를 지원한다.

#### 상세 요구사항
- **FR-04-01-01**: 채팅방 생성
  - 매칭 성공 시 자동으로 채팅방이 생성된다
  - 각 채팅방은 고유한 ID를 가진다
  - 최대 참여 인원: 2명 (1:1 채팅)
  
- **FR-04-01-02**: 채팅방 조회
  - 사용자는 참여 중인 채팅방 목록을 조회할 수 있다
  - 최근 메시지와 시간이 함께 표시된다
  - 읽지 않은 메시지 수가 표시된다
  
- **FR-04-01-03**: 채팅방 나가기
  - 사용자는 채팅방을 나갈 수 있다
  - 나간 사용자에게는 이후 메시지가 전달되지 않는다

### FR-04-02: 메시지 전송 및 수신
**우선순위**: 필수 (P0)  
**설명**: WebSocket 기반 실시간 메시지 통신을 지원한다.

#### 상세 요구사항
- **FR-04-02-01**: 텍스트 메시지
  - 사용자는 텍스트 메시지를 전송할 수 있다
  - 최대 길이: 1,000자
  - 이모지 및 특수 문자 지원
  
- **FR-04-02-02**: 이미지 메시지
  - 사용자는 이미지를 전송할 수 있다
  - 지원 형식: JPG, PNG, GIF
  - 최대 크기: 10MB
  
- **FR-04-02-03**: 메시지 상태 관리
  - 메시지 전송 상태: 전송 중, 전송 완료, 전송 실패
  - 메시지 읽음 상태: 읽지 않음, 읽음
  - 실시간으로 상태 업데이트

#### 기술적 구현
```yaml
WebSocket 프로토콜:
  - STOMP over WebSocket 사용
  - 연결 엔드포인트: /ws
  - 구독 패턴: /topic/chat/{roomId}
  - 발송 패턴: /app/chat/send

메시지 저장:
  - 모든 메시지는 데이터베이스에 저장
  - Redis를 통한 실시간 캐싱
  - 메시지 암호화 저장 (선택사항)
```

### FR-04-03: 채팅 기능 확장
**우선순위**: 보통 (P2)  
**설명**: 채팅 경험을 향상시키는 부가 기능들을 제공한다.

#### 상세 요구사항
- **FR-04-03-01**: 메시지 검색
  - 채팅방 내 메시지를 검색할 수 있다
  - 키워드 기반 검색 지원
  
- **FR-04-03-02**: 메시지 번역
  - 외부 번역 API를 활용한 메시지 번역
  - 실시간 번역 토글 기능
  
- **FR-04-03-03**: 언어 교정
  - AI를 활용한 문법 및 표현 교정 제안
  - 교정 제안은 선택적으로 표시

---

## 🤝 FR-05: 매칭 시스템

### FR-05-01: 자동 매칭
**우선순위**: 필수 (P0)  
**설명**: 사용자의 프로필과 선호도를 기반으로 최적의 파트너를 매칭한다.

#### 상세 요구사항
- **FR-05-01-01**: 매칭 알고리즘
  - 언어 수준의 상호 보완성을 고려한다
  - 학습 목표와 스타일의 유사성을 평가한다
  - 시간대와 활동 시간을 매칭한다
  - 사용자 선호도를 우선순위에 반영한다
  
- **FR-05-01-02**: 매칭 요청
  - 사용자는 매칭을 요청할 수 있다
  - 매칭 대기 상태가 표시된다
  - 매칭 취소가 가능하다
  
- **FR-05-01-03**: 매칭 결과 처리
  - 매칭 성공 시 양쪽 사용자에게 알림을 발송한다
  - 매칭 수락/거절 옵션을 제공한다
  - 양쪽 모두 수락 시 채팅방이 생성된다

#### 매칭 점수 계산
```yaml
가중치:
  - 언어 수준 호환성: 40%
  - 학습 목표 유사성: 25%  
  - 시간대 매칭: 20%
  - 사용자 선호도: 15%

점수 범위: 0-100점
매칭 임계값: 60점 이상
```

### FR-05-02: 매칭 관리
**우선순위**: 중요 (P1)  
**설명**: 매칭 히스토리와 피드백을 관리한다.

#### 상세 요구사항
- **FR-05-02-01**: 매칭 히스토리
  - 과거 매칭 기록을 조회할 수 있다
  - 매칭 성공/실패 통계를 제공한다
  
- **FR-05-02-02**: 매칭 피드백
  - 매칭 후 파트너에 대한 피드백을 제공할 수 있다
  - 피드백은 향후 매칭 개선에 활용된다
  
- **FR-05-02-03**: 차단 및 신고
  - 부적절한 사용자를 차단할 수 있다
  - 신고 기능을 통해 운영진에게 문제를 보고한다

---

## 🧠 FR-06: AI 레벨 테스트

### FR-06-01: 음성 기반 레벨 테스트
**우선순위**: 중요 (P1)  
**설명**: 음성 인식과 AI 분석을 통한 영어 실력 진단을 제공한다.

#### 상세 요구사항
- **FR-06-01-01**: 음성 녹음 및 분석
  - 사용자는 주어진 문장을 음성으로 녹음한다
  - 녹음된 음성을 텍스트로 변환한다
  - 발음, 문법, 유창성을 종합 분석한다
  
- **FR-06-01-02**: 테스트 문항 관리
  - 난이도별 문항을 제공한다
  - 적응적 테스트 방식으로 문항 선별한다
  - 실생활 상황 기반 문제를 출제한다
  
- **FR-06-01-03**: 결과 분석 및 피드백
  - CEFR 기준 레벨을 산정한다
  - 세부 영역별 (문법, 어휘, 발음) 점수를 제공한다
  - 개선 방안과 학습 추천을 제시한다

#### 기술적 구현
```yaml
외부 API 연동:
  - Clova Speech Recognition API
  - Clova Studio API (언어 분석)
  - 음성 파일 처리: WebM, MP3 지원

분석 항목:
  - 발음 정확도 (Pronunciation)
  - 문법 정확성 (Grammar)
  - 어휘 다양성 (Vocabulary)
  - 유창성 (Fluency)
```

### FR-06-02: 테스트 결과 관리
**우선순위**: 중요 (P1)  
**설명**: 테스트 결과의 저장, 조회, 비교 기능을 제공한다.

#### 상세 요구사항
- **FR-06-02-01**: 결과 저장 및 조회
  - 모든 테스트 결과를 히스토리로 저장한다
  - 사용자는 과거 결과를 조회할 수 있다
  - 진전 상황을 그래프로 시각화한다
  
- **FR-06-02-02**: 결과 기반 추천
  - 테스트 결과에 기반한 학습 콘텐츠를 추천한다
  - 약점 영역 집중 학습 가이드를 제공한다
  - 적정 매칭 파트너 레벨을 제안한다

---

## 📞 FR-07: 화상/음성 통화

### FR-07-01: WebRTC 기반 통화
**우선순위**: 중요 (P1)  
**설명**: P2P 방식의 고품질 화상/음성 통화를 지원한다.

#### 상세 요구사항
- **FR-07-01-01**: 통화 시작 및 종료
  - 채팅방에서 직접 통화를 시작할 수 있다
  - 음성 통화와 화상 통화 모드를 선택한다
  - 통화 중 모드 변경이 가능하다
  
- **FR-07-01-02**: 미디어 제어
  - 마이크 음소거/해제가 가능하다
  - 카메라 켜기/끄기가 가능하다
  - 화면 공유 기능을 제공한다
  
- **FR-07-01-03**: 연결 품질 관리
  - 실시간 연결 상태를 모니터링한다
  - 네트워크 상태에 따른 품질 조정을 한다
  - 연결 실패 시 자동 재연결을 시도한다

#### 기술적 구현
```yaml
WebRTC 구성:
  - STUN/TURN 서버: Cloudflare Workers
  - Signaling: WebSocket 기반
  - 코덱: VP8/VP9 (비디오), Opus (오디오)

네트워크 요구사항:
  - 최소 대역폭: 128kbps (음성), 512kbps (화상)
  - 지연시간: < 150ms
  - 패킷 손실률: < 1%
```

### FR-07-02: 통화 기능 확장
**우선순위**: 보통 (P2)  
**설명**: 언어 학습을 돕는 통화 부가 기능들을 제공한다.

#### 상세 요구사항
- **FR-07-02-01**: 통화 녹음
  - 사용자 동의 하에 통화를 녹음할 수 있다
  - 녹음 파일은 학습 복습용으로 활용한다
  
- **FR-07-02-02**: 실시간 자막
  - 음성을 실시간으로 텍스트로 변환한다
  - 다국어 자막을 지원한다
  
- **FR-07-02-03**: 통화 품질 피드백
  - 통화 종료 후 품질 평가를 수집한다
  - 기술적 문제점을 보고할 수 있다

---

## 📊 FR-08: 학습 관리

### FR-08-01: 학습 통계 및 진도 추적
**우선순위**: 중요 (P1)  
**설명**: 사용자의 학습 활동을 추적하고 통계를 제공한다.

#### 상세 요구사항
- **FR-08-01-01**: 활동 통계
  - 일/주/월별 학습 시간을 집계한다
  - 채팅 메시지 수와 통화 시간을 기록한다
  - 매칭 성공률과 만족도를 추적한다
  
- **FR-08-01-02**: 학습 진도 관리
  - 언어 레벨 향상 기록을 관리한다
  - 목표 달성률을 계산한다
  - 주요 마일스톤을 표시한다
  
- **FR-08-01-03**: 성취 시스템
  - 학습 목표 달성 시 배지를 수여한다
  - 연속 학습 일수를 기록한다
  - 리더보드를 통한 동기 부여한다

#### 통계 지표
```yaml
핵심 지표:
  - 총 학습 시간
  - 주간 활성 일수
  - 매칭 성공률
  - 레벨 테스트 점수 변화
  - 파트너 만족도 평균

세부 지표:
  - 채팅 메시지 수
  - 통화 총 시간
  - 화면 공유 사용 횟수
  - AI 교정 수용률
```

### FR-08-02: 학습 추천 시스템
**우선순위**: 보통 (P2)  
**설명**: AI 기반 개인화된 학습 추천을 제공한다.

#### 상세 요구사항
- **FR-08-02-01**: 개인화 콘텐츠 추천
  - 사용자의 약점 영역을 분석한다
  - 맞춤형 학습 자료를 추천한다
  - 적절한 난이도의 파트너를 제안한다
  
- **FR-08-02-02**: 학습 계획 수립
  - 목표 기반 학습 로드맵을 제시한다
  - 주간 학습 계획을 자동 생성한다
  - 진도에 따른 계획 조정을 수행한다

---

## 📱 비기능적 요구사항

### NFR-01: 성능 요구사항
```yaml
응답 시간:
  - API 응답: < 200ms (평균)
  - 채팅 메시지 전송: < 100ms
  - 매칭 처리: < 5초

처리량:
  - 동시 사용자: 1,000명
  - 메시지 처리: 10,000건/분
  - API 호출: 100,000건/시간

가용성:
  - 서비스 가동률: 99.5%
  - 최대 다운타임: 4시간/월
```

### NFR-02: 보안 요구사항
```yaml
인증:
  - JWT 토큰 기반 무상태 인증
  - OAuth 2.0 표준 준수
  - 토큰 만료 시간 관리

데이터 보호:
  - 개인정보 암호화 저장
  - HTTPS 통신 강제
  - SQL Injection 방지

권한 관리:
  - 역할 기반 접근 제어
  - API 레이트 리미팅
  - 세션 관리 및 무효화
```

### NFR-03: 사용성 요구사항
```yaml
접근성:
  - WCAG 2.1 AA 수준 준수
  - 키보드 네비게이션 지원
  - 스크린 리더 호환

다국어:
  - 한국어, 영어 UI 지원
  - RTL 언어 지원 고려
  - 지역화된 날짜/시간 형식

호환성:
  - 최신 3개 버전 브라우저 지원
  - 모바일 반응형 디자인
  - Progressive Web App (PWA)
```

---

## ✅ 인수 기준 매트릭스

| 기능 영역 | 필수 기능 | 개발 완료 | 테스트 완료 | 배포 준비 |
|-----------|-----------|-----------|-------------|-----------|
| 사용자 관리 | ✅ | ✅ | ✅ | ✅ |
| 인증/권한 | ✅ | ✅ | ✅ | ✅ |
| 온보딩 | ✅ | ✅ | ⏳ | ⏳ |
| 실시간 채팅 | ✅ | ✅ | ⏳ | ⏳ |
| 매칭 시스템 | ✅ | ⏳ | ❌ | ❌ |
| AI 레벨 테스트 | ⭐ | ✅ | ⏳ | ⏳ |
| 화상/음성 통화 | ⭐ | ⏳ | ❌ | ❌ |
| 학습 관리 | ⭐ | ❌ | ❌ | ❌ |

**범례**: ✅ 완료, ⏳ 진행 중, ❌ 미시작, ⭐ 중요도 높음

---

## 📚 관련 문서

- [프로젝트 개요](../01-overview/project-overview.md)
- [목표 및 성과 지표](../01-overview/goals-and-objectives.md)
- [시스템 아키텍처](../03-architecture/system-architecture.md)
- [API 레퍼런스](../04-api/api-reference.md)
- [데이터베이스 설계](../05-database/database-schema.md)